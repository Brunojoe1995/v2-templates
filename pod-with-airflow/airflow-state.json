{
  "version": 4,
  "terraform_version": "1.1.9",
  "serial": 33,
  "lineage": "89d1e1b3-24cb-16c3-9712-845ee26473d6",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "coder_workspace",
      "name": "me",
      "provider": "provider[\"registry.terraform.io/coder/coder\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_url": "https://oss.demo.coder.com",
            "id": "57da191c-29e8-490c-9de0-a54b928ee3bf",
            "name": "airflow",
            "owner": "admin",
            "owner_id": "efd27bcc-62c1-4baf-8557-3896b9ed39cd",
            "start_count": 1,
            "transition": "start"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "coder_agent",
      "name": "coder",
      "provider": "provider[\"registry.terraform.io/coder/coder\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arch": "amd64",
            "auth": "token",
            "dir": "/home/coder",
            "env": null,
            "id": "d65ec32a-7937-42aa-82aa-0e9ca67cec1c",
            "init_script": "#!/usr/bin/env sh\nset -eux pipefail\nBINARY_DIR=$(mktemp -d -t coder.XXXXXX)\nBINARY_NAME=coder\nBINARY_URL=https://oss.demo.coder.com/bin/coder-linux-amd64\ncd $BINARY_DIR\nif command -v curl \u003e/dev/null 2\u003e\u00261; then\n\tcurl -fsSL --compressed \"${BINARY_URL}\" -o \"${BINARY_NAME}\"\nelif command -v wget \u003e/dev/null 2\u003e\u00261; then\n\twget -q \"${BINARY_URL}\" -O \"${BINARY_NAME}\"\nelif command -v busybox \u003e/dev/null 2\u003e\u00261; then\n\tbusybox wget -q \"${BINARY_URL}\" -O \"${BINARY_NAME}\"\nelse\n\techo \"error: no download tool found, please install curl, wget or busybox wget\"\n\texit 1\nfi\nchmod +x $BINARY_NAME\nexport CODER_AGENT_AUTH=\"token\"\nexport CODER_AGENT_URL=\"https://oss.demo.coder.com/\"\nexec ./$BINARY_NAME agent",
            "os": "linux",
            "startup_script": "#!/bin/bash\n\n# install code-server\ncurl -fsSL https://code-server.dev/install.sh | sh \ncode-server --auth none --port 13337 \u0026\n\n# install and start airflow\npip3 install apache-airflow 2\u003e\u00261 | tee airflow-install.log\n#export AIRFLOW__WEBSERVER__BASE_URL=\"https://localhost:8080/./\"\n/home/coder/.local/bin/airflow standalone \u0026  2\u003e\u00261 | tee airflow-run.log\n\n# add some Python libraries\npip3 install --user pandas numpy\n\n# use coder CLI to clone and install dotfiles\ncoder dotfiles -y git@github.com:mark-theshark/dotfiles.git 2\u003e\u00261 | tee ~/dotfiles.log\n\n# clone repo\nssh-keyscan -t rsa github.com \u003e\u003e ~/.ssh/known_hosts\ngit clone --progress git@github.com:mark-theshark/airflow_wac.git 2\u003e\u00261 | tee repo-clone.log\n\n",
            "token": "14e756bb-0f1c-4842-ac0b-e121cf4dd6d7"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "coder_app",
      "name": "code-server",
      "provider": "provider[\"registry.terraform.io/coder/coder\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_id": "d65ec32a-7937-42aa-82aa-0e9ca67cec1c",
            "command": null,
            "icon": "https://cdn.icon-icons.com/icons2/2107/PNG/512/file_type_vscode_icon_130084.png",
            "id": "af334964-be4f-47f9-801e-8b7b8bcbfa61",
            "name": "code-server",
            "relative_path": true,
            "url": "http://localhost:13337?folder=/home/coder"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "coder_agent.coder"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_persistent_volume_claim",
      "name": "home-directory",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "oss/home-coder-admin-airflow",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {},
                "name": "home-coder-admin-airflow",
                "namespace": "oss",
                "resource_version": "182043974",
                "uid": "4d31648a-9485-4442-895e-ef674aac9927"
              }
            ],
            "spec": [
              {
                "access_modes": [
                  "ReadWriteOnce"
                ],
                "resources": [
                  {
                    "limits": {},
                    "requests": {
                      "storage": "10Gi"
                    }
                  }
                ],
                "selector": [],
                "storage_class_name": "standard",
                "volume_name": "pvc-4d31648a-9485-4442-895e-ef674aac9927"
              }
            ],
            "timeouts": null,
            "wait_until_bound": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "metadata"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "namespace"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.coder_workspace.me"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_pod",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "id": "oss/coder-admin-airflow",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": null,
                "name": "coder-admin-airflow",
                "namespace": "oss",
                "resource_version": "182054995",
                "uid": "44eca27b-a4d1-48c3-8a88-46f369b2a617"
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "affinity": [],
                "automount_service_account_token": true,
                "container": [
                  {
                    "args": null,
                    "command": [
                      "sh",
                      "-c",
                      "#!/usr/bin/env sh\nset -eux pipefail\nBINARY_DIR=$(mktemp -d -t coder.XXXXXX)\nBINARY_NAME=coder\nBINARY_URL=https://oss.demo.coder.com/bin/coder-linux-amd64\ncd $BINARY_DIR\nif command -v curl \u003e/dev/null 2\u003e\u00261; then\n\tcurl -fsSL --compressed \"${BINARY_URL}\" -o \"${BINARY_NAME}\"\nelif command -v wget \u003e/dev/null 2\u003e\u00261; then\n\twget -q \"${BINARY_URL}\" -O \"${BINARY_NAME}\"\nelif command -v busybox \u003e/dev/null 2\u003e\u00261; then\n\tbusybox wget -q \"${BINARY_URL}\" -O \"${BINARY_NAME}\"\nelse\n\techo \"error: no download tool found, please install curl, wget or busybox wget\"\n\texit 1\nfi\nchmod +x $BINARY_NAME\nexport CODER_AGENT_AUTH=\"token\"\nexport CODER_AGENT_URL=\"https://oss.demo.coder.com/\"\nexec ./$BINARY_NAME agent"
                    ],
                    "env": [
                      {
                        "name": "CODER_AGENT_TOKEN",
                        "value": "14e756bb-0f1c-4842-ac0b-e121cf4dd6d7",
                        "value_from": []
                      }
                    ],
                    "env_from": [],
                    "image": "docker.io/codercom/enterprise-base:ubuntu",
                    "image_pull_policy": "Always",
                    "lifecycle": [],
                    "liveness_probe": [],
                    "name": "airflow",
                    "port": [],
                    "readiness_probe": [],
                    "resources": [
                      {
                        "limits": {
                          "cpu": "1",
                          "memory": "2G"
                        },
                        "requests": {
                          "cpu": "250m",
                          "memory": "250Mi"
                        }
                      }
                    ],
                    "security_context": [
                      {
                        "allow_privilege_escalation": true,
                        "capabilities": [],
                        "privileged": false,
                        "read_only_root_filesystem": false,
                        "run_as_group": "",
                        "run_as_non_root": false,
                        "run_as_user": "1000",
                        "se_linux_options": [],
                        "seccomp_profile": []
                      }
                    ],
                    "startup_probe": [],
                    "stdin": false,
                    "stdin_once": false,
                    "termination_message_path": "/dev/termination-log",
                    "termination_message_policy": "File",
                    "tty": false,
                    "volume_mount": [
                      {
                        "mount_path": "/home/coder",
                        "mount_propagation": "None",
                        "name": "home-directory",
                        "read_only": false,
                        "sub_path": ""
                      }
                    ],
                    "working_dir": ""
                  }
                ],
                "dns_config": [],
                "dns_policy": "ClusterFirst",
                "enable_service_links": true,
                "host_aliases": [],
                "host_ipc": false,
                "host_network": false,
                "host_pid": false,
                "hostname": "",
                "image_pull_secrets": [],
                "init_container": [],
                "node_name": "gke-demo-2-coder-node-pool-158d88b7-vfbm",
                "node_selector": null,
                "priority_class_name": "",
                "readiness_gate": [],
                "restart_policy": "Always",
                "security_context": [
                  {
                    "fs_group": "1000",
                    "run_as_group": "",
                    "run_as_non_root": false,
                    "run_as_user": "1000",
                    "se_linux_options": [],
                    "seccomp_profile": [],
                    "supplemental_groups": null,
                    "sysctl": []
                  }
                ],
                "service_account_name": "default",
                "share_process_namespace": false,
                "subdomain": "",
                "termination_grace_period_seconds": 30,
                "toleration": [],
                "topology_spread_constraint": [],
                "volume": [
                  {
                    "aws_elastic_block_store": [],
                    "azure_disk": [],
                    "azure_file": [],
                    "ceph_fs": [],
                    "cinder": [],
                    "config_map": [],
                    "csi": [],
                    "downward_api": [],
                    "empty_dir": [],
                    "fc": [],
                    "flex_volume": [],
                    "flocker": [],
                    "gce_persistent_disk": [],
                    "git_repo": [],
                    "glusterfs": [],
                    "host_path": [],
                    "iscsi": [],
                    "local": [],
                    "name": "home-directory",
                    "nfs": [],
                    "persistent_volume_claim": [
                      {
                        "claim_name": "home-coder-admin-airflow",
                        "read_only": false
                      }
                    ],
                    "photon_persistent_disk": [],
                    "projected": [],
                    "quobyte": [],
                    "rbd": [],
                    "secret": [],
                    "vsphere_volume": []
                  }
                ]
              }
            ],
            "timeouts": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "metadata"
              },
              {
                "type": "index",
                "value": {
                  "value": 0,
                  "type": "number"
                }
              },
              {
                "type": "get_attr",
                "value": "namespace"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "coder_agent.coder",
            "data.coder_workspace.me",
            "kubernetes_persistent_volume_claim.home-directory"
          ]
        }
      ]
    }
  ]
}
